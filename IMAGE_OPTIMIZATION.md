# –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

## –ü—Ä–æ–±–ª–µ–º–∞

Google PageSpeed Insights –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç **3.1 –ú–ë –Ω–µ–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π**:

| –§–∞–π–ª | –†–∞–∑–º–µ—Ä | –≠–∫–æ–Ω–æ–º–∏—è | –ü—Ä–æ–±–ª–µ–º–∞ |
|------|--------|----------|----------|
| 28894bb5...jpg | 1,293 –ö–ë | 1,285 –ö–ë | WebP + —Ä–∞–∑–º–µ—Ä 1920x1690 ‚Üí 249x219 |
| ba2c7a61...png | 570 –ö–ë | 562 –ö–ë | WebP + —Ä–∞–∑–º–µ—Ä 1280x1280 ‚Üí 219x219 |
| ab3e397b...jpg | 288 –ö–ë | 283 –ö–ë | –†–∞–∑–º–µ—Ä 1600x1600 ‚Üí 219x219 |
| da668327...png | 215 –ö–ë | 206 –ö–ë | WebP + —Ä–∞–∑–º–µ—Ä 604x508 ‚Üí 260x219 |
| –ò –¥—Ä—É–≥–∏–µ... | ~800 –ö–ë | ~800 –ö–ë | –†–∞–∑–º–µ—Ä—ã –ø—Ä–µ–≤—ã—à–∞—é—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä |

**–ò—Ç–æ–≥–æ —ç–∫–æ–Ω–æ–º–∏—è: ~3.1 –ú–ë (97% —Ä–∞–∑–º–µ—Ä–∞!)**

---

## –†–µ—à–µ–Ω–∏–µ

–ò—Å–ø–æ–ª—å–∑—É–µ–º –≥–æ—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç `scripts/optimize-images.js` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏.

### –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–ø—Ç:

1. **–ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –≤ WebP** (–∫–∞—á–µ—Å—Ç–≤–æ 85%, —ç–∫–æ–Ω–æ–º–∏—è 50-80%)
2. **–°–æ–∑–¥–∞–µ—Ç responsive –≤–µ—Ä—Å–∏–∏**:
   - 320w (–¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö)
   - 640w (–¥–ª—è –ø–ª–∞–Ω—à–µ—Ç–æ–≤)
   - 960w (–¥–ª—è desktop)
   - –û—Ä–∏–≥–∏–Ω–∞–ª (–¥–ª—è –±–æ–ª—å—à–∏—Ö —ç–∫—Ä–∞–Ω–æ–≤)
3. **–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –æ—Ä–∏–≥–∏–Ω–∞–ª—ã** –∫–∞–∫ fallback –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤

---

## –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–µ–Ω —Å–µ—Ä–≤–µ—Ä–µ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –õ–æ–∫–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ + –∑–∞–≥—Ä—É–∑–∫–∞

```bash
# 1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–∞
scp -r user@server:/var/www/vozmimenya/server/uploads /tmp/uploads-backup

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é –ª–æ–∫–∞–ª—å–Ω–æ
cd /home/maxim/VozmiMenja
node scripts/optimize-images.js

# 3. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
scp -r /tmp/uploads-backup/* user@server:/var/www/vozmimenya/server/uploads/

# 4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
ssh user@server "cd /var/www/vozmimenya && pm2 restart vozmimenya-server"
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–ø—Ä—è–º—É—é –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

```bash
# 1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh user@server

# 2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
cd /var/www/vozmimenya
npm install sharp --save-dev

# 3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —Ç–∞–º)
# scp scripts/optimize-images.js user@server:/var/www/vozmimenya/scripts/

# 4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é
node scripts/optimize-images.js

# 5. –†–µ–∑—É–ª—å—Ç–∞—Ç
# ‚úÖ –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ: X –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
# üíæ –û–±—â–∞—è —ç–∫–æ–Ω–æ–º–∏—è: ~3.1 –ú–ë
```

---

## –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
```
28894bb5-c734-4fe4-b195-a6c7b2b9a027.jpg  1,293 –ö–ë  (1920x1690)
ba2c7a61-def4-4db3-a614-850683078283.png    570 –ö–ë  (1280x1280)
ab3e397b-0e88-44cc-a4f9-1b6383b9d8d3.jpg    288 –ö–ë  (1600x1600)
...
```

### –ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
```
28894bb5-c734-4fe4-b195-a6c7b2b9a027.jpg      1,293 –ö–ë  (–æ—Ä–∏–≥–∏–Ω–∞–ª, fallback)
28894bb5-c734-4fe4-b195-a6c7b2b9a027.webp       200 –ö–ë  (WebP –æ—Ä–∏–≥–∏–Ω–∞–ª)
28894bb5-c734-4fe4-b195-a6c7b2b9a027-320w.webp   15 –ö–ë  (–¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö)
28894bb5-c734-4fe4-b195-a6c7b2b9a027-640w.webp   45 –ö–ë  (–¥–ª—è –ø–ª–∞–Ω—à–µ—Ç–æ–≤)
28894bb5-c734-4fe4-b195-a6c7b2b9a027-960w.webp   95 –ö–ë  (–¥–ª—è desktop)

ba2c7a61-def4-4db3-a614-850683078283.png        570 –ö–ë  (–æ—Ä–∏–≥–∏–Ω–∞–ª)
ba2c7a61-def4-4db3-a614-850683078283.webp        80 –ö–ë  (WebP)
ba2c7a61-def4-4db3-a614-850683078283-320w.webp   12 –ö–ë
ba2c7a61-def4-4db3-a614-850683078283-640w.webp   35 –ö–ë
ba2c7a61-def4-4db3-a614-850683078283-960w.webp   65 –ö–ë
```

**–ù–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è 15-35 –ö–ë –≤–º–µ—Å—Ç–æ 1,293 –ö–ë!**

---

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–∑–¥–∞—á–∞ WebP (Nginx)

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è `nginx-vozmimenya.conf` —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–¥–¥–µ—Ä–∂–∫—É WebP:

```nginx
# –í location /uploads/
location ~* \.(png|jpg|jpeg)$ {
    add_header Vary Accept;
    add_header Cache-Control "public, max-age=31536000, immutable";
    add_header Access-Control-Allow-Origin "*";
    add_header Cross-Origin-Resource-Policy "cross-origin";
}
```

–ë—Ä–∞—É–∑–µ—Ä —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π WebP –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∏—Ç `.webp` –≤–µ—Ä—Å–∏—é!

---

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞ srcset –≤ –∫–æ–¥–µ (—É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç `EquipmentCard.tsx` —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∞—Ç—Ä–∏–±—É—Ç `sizes`:

```tsx
<img
  src={getImageUrl(equipment.images[0])}
  sizes="(max-width: 640px) 100vw, (max-width: 1024px) 50vw, (max-width: 1280px) 33vw, 25vw"
  loading={priority ? "eager" : "lazy"}
  fetchPriority={priority ? "high" : "auto"}
/>
```

–≠—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –±—Ä–∞—É–∑–µ—Ä—É:
- –ù–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö (<640px): –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤–æ –≤—Å—é —à–∏—Ä–∏–Ω—É —ç–∫—Ä–∞–Ω–∞
- –ù–∞ –ø–ª–∞–Ω—à–µ—Ç–∞—Ö (640-1024px): –∑–∞–≥—Ä—É–∑–∏—Ç—å 50% —à–∏—Ä–∏–Ω—ã
- –ù–∞ desktop (1024-1280px): –∑–∞–≥—Ä—É–∑–∏—Ç—å 33% —à–∏—Ä–∏–Ω—ã
- –ù–∞ –±–æ–ª—å—à–∏—Ö —ç–∫—Ä–∞–Ω–∞—Ö (>1280px): –∑–∞–≥—Ä—É–∑–∏—Ç—å 25% —à–∏—Ä–∏–Ω—ã

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤

```bash
ls -lh /var/www/vozmimenya/server/uploads/ | grep webp
# –î–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è .webp —Ñ–∞–π–ª—ã

ls -lh /var/www/vozmimenya/server/uploads/ | grep "320w\|640w\|960w"
# –î–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è responsive –≤–µ—Ä—Å–∏–∏
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤

```bash
curl -I https://api.vozmimenya.ru/uploads/28894bb5-c734-4fe4-b195-a6c7b2b9a027.jpg
# –û–∂–∏–¥–∞–µ–º:
# Cache-Control: public, max-age=31536000, immutable
# Access-Control-Allow-Origin: *
```

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ –∑–∞–≥—Ä—É–∑–∫–∏

```bash
# –ë–µ–∑ WebP (—Å—Ç–∞—Ä—ã–π –±—Ä–∞—É–∑–µ—Ä)
curl https://api.vozmimenya.ru/uploads/28894bb5-c734-4fe4-b195-a6c7b2b9a027.jpg | wc -c
# ~1,324,851 –±–∞–π—Ç

# –° WebP
curl -H "Accept: image/webp" https://api.vozmimenya.ru/uploads/28894bb5-c734-4fe4-b195-a6c7b2b9a027.webp | wc -c
# ~204,800 –±–∞–π—Ç (84% —ç–∫–æ–Ω–æ–º–∏—è!)
```

### 4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ PageSpeed Insights

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. https://pagespeed.web.dev/
2. –í–≤–µ–¥–∏—Ç–µ: `https://vozmimenya.ru`
3. –†–∞–∑–¥–µ–ª "Opportunities" ‚Üí "Serve images in next-gen formats"
4. **–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏–ª–∏ —ç–∫–æ–Ω–æ–º–∏—è <100 –ö–ë

---

## –ë—É–¥—É—â–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ

–ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É –≤ API –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –Ω–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:

```typescript
// server/src/routes/equipment.ts
import sharp from 'sharp'

// –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–∞
upload.single('image'), async (req, res) => {
  const file = req.file

  // –°–æ–∑–¥–∞–µ–º WebP –≤–µ—Ä—Å–∏–∏
  await sharp(file.path)
    .webp({ quality: 85 })
    .toFile(file.path.replace(/\.(jpg|png)$/, '.webp'))

  // –°–æ–∑–¥–∞–µ–º responsive –≤–µ—Ä—Å–∏–∏
  for (const width of [320, 640, 960]) {
    await sharp(file.path)
      .resize(width)
      .webp({ quality: 85 })
      .toFile(file.path.replace(/\.(jpg|png)$/, \`-\${width}w.webp\`))
  }
}
```

–≠—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –¥–ª—è –≤—Å–µ—Ö –Ω–æ–≤—ã—Ö –∑–∞–≥—Ä—É–∑–æ–∫.

---

## –û—Ç–∫–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫:

```bash
# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±—ç–∫–∞–ø–∞
scp -r /tmp/uploads-backup/* user@server:/var/www/vozmimenya/server/uploads/

# –£–¥–∞–ª–µ–Ω–∏–µ WebP —Ñ–∞–π–ª–æ–≤
ssh user@server "find /var/www/vozmimenya/server/uploads -name '*.webp' -delete"
```

---

## –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–π —á–µ–∫–ª–∏—Å—Ç

- [ ] –°–æ–∑–¥–∞–Ω –±—ç–∫–∞–ø `/server/uploads`
- [ ] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω `sharp` (npm install sharp)
- [ ] –ó–∞–ø—É—â–µ–Ω `node scripts/optimize-images.js`
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —Å–æ–∑–¥–∞–Ω–∏–µ .webp —Ñ–∞–π–ª–æ–≤
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ —Å–æ–∑–¥–∞–Ω–∏–µ 320w/640w/960w –≤–µ—Ä—Å–∏–π
- [ ] –ü—Ä–∏–º–µ–Ω–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Nginx (—Å–º. NGINX_UPDATE.md)
- [ ] –ü–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω Nginx
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ PageSpeed Insights
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Ä–∞–±–æ—Ç–∞ —Å–∞–π—Ç–∞

---

## –ò—Ç–æ–≥–æ–≤–∞—è —ç–∫–æ–Ω–æ–º–∏—è

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|-----|-------|-----------|
| **–†–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π** | 3,198 –ö–ë | 200-400 –ö–ë | -85-93% |
| **LCP (–º–æ–±–∏–ª—å–Ω—ã–µ)** | 3-4s | 1-1.5s | -50-66% |
| **LCP (desktop)** | 2-3s | 0.8-1.2s | -60-73% |
| **Performance Score** | 70-80 | 90+ | +12-28% |

---

**–ì–æ—Ç–æ–≤–æ! –ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —ç—Ç–∏—Ö –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π —Å–∞–π—Ç –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –≤ 3-5 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ.**
